# ğŸš€ Project Aegis - ç”Ÿäº§çº§æ‰©å±•è·¯çº¿å›¾

## ğŸ“‹ ç›®å½•
1. [å½“å‰ MVP æ¶æ„](#å½“å‰-mvp-æ¶æ„)
2. [ç”Ÿäº§çº§æ‰©å±•æ–¹æ¡ˆ](#ç”Ÿäº§çº§æ‰©å±•æ–¹æ¡ˆ)
3. [æŠ€æœ¯æ ˆå‡çº§](#æŠ€æœ¯æ ˆå‡çº§)
4. [éƒ¨ç½²æ–¹æ¡ˆ](#éƒ¨ç½²æ–¹æ¡ˆ)
5. [æˆæœ¬ä¼°ç®—](#æˆæœ¬ä¼°ç®—)

---

## å½“å‰ MVP æ¶æ„

### æŠ€æœ¯æ ˆ
```
Frontend: Streamlit (Python Web Framework)
Data Processing: Pandas + NumPy
Visualization: Plotly
Data Generation: Faker (æ¨¡æ‹Ÿæ•°æ®)
```

### æ•°æ®æµ
```
[æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆ] â†’ [Pandas å¤„ç†] â†’ [Streamlit æ¸²æŸ“] â†’ [æµè§ˆå™¨å±•ç¤º]
```

### ä¼˜åŠ¿
- âœ… å¿«é€ŸåŸå‹éªŒè¯ (2 å°æ—¶å¼€å‘å®Œæˆ)
- âœ… é›¶åŸºç¡€è®¾æ–½æˆæœ¬
- âœ… æ˜“äºæ¼”ç¤ºå’Œè¿­ä»£

### å±€é™
- âŒ æ•°æ®æ˜¯æ¨¡æ‹Ÿçš„ (éå®æ—¶)
- âŒ æ— æŒä¹…åŒ–å­˜å‚¨
- âŒ å•æœºè¿è¡Œ,æ— æ³•å¤šäººåä½œ
- âŒ æ— å‘Šè­¦é€šçŸ¥æœºåˆ¶

---

## ç”Ÿäº§çº§æ‰©å±•æ–¹æ¡ˆ

### Phase 1: æ•°æ®æºå¯¹æ¥ (Week 1-2)

#### 1.1 TikTok Shop API é›†æˆ
```python
# æ›¿æ¢æ¨¡æ‹Ÿæ•°æ®ç”Ÿæˆå‡½æ•°
@st.cache_data(ttl=300)  # 5åˆ†é’Ÿç¼“å­˜
def fetch_shop_data_from_api():
    """ä» TikTok Shop API è·å–å®æ—¶åº—é“ºæ•°æ®"""
    response = requests.get(
        'https://api.tiktokshop.com/v1/shops',
        headers={'Authorization': f'Bearer {TIKTOK_API_KEY}'},
        params={'fields': 'sps_score,daily_orders,nrr,region'}
    )
    return pd.DataFrame(response.json()['data'])
```

**æ‰€éœ€ API**:
- Shop Performance API (SPS åˆ†æ•°)
- Order API (è®¢å•é‡)
- Review API (å·®è¯„æ•°æ®)
- Ad Campaign API (Smart+ ROAS æ•°æ®)

**è®¤è¯æ–¹å¼**:
- OAuth 2.0
- API Key å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ (`.env` æ–‡ä»¶)

---

#### 1.2 ç‰©æµå•† API é›†æˆ
```python
def fetch_logistics_data():
    """è·å–å®æ—¶ç‰©æµæ‹¥å µæ•°æ®"""
    # FedEx API
    fedex_data = fetch_fedex_tracking_delays()

    # UPS API
    ups_data = fetch_ups_port_congestion()

    # åˆå¹¶æ•°æ®
    return merge_logistics_data(fedex_data, ups_data)
```

**æ•°æ®æº**:
- FedEx Ship API
- UPS Tracking API
- ç¬¬ä¸‰æ–¹ç‰©æµæ•°æ®å¹³å° (å¦‚ Flexport)

---

### Phase 2: AI èƒ½åŠ›å¢å¼º (Week 3-4)

#### 2.1 æ¥å…¥ LLM API
```python
import openai

def analyze_review_with_llm(review_text):
    """ä½¿ç”¨ GPT-4 åˆ†æå·®è¯„"""
    response = openai.ChatCompletion.create(
        model="gpt-4",
        messages=[
            {"role": "system", "content": """
            ä½ æ˜¯ TikTok Shop çš„å·®è¯„åˆ†æä¸“å®¶ã€‚
            ä»»åŠ¡: åˆ¤æ–­å·®è¯„æ˜¯ "ç‰©æµé—®é¢˜" (å¯ç”³è¯‰) è¿˜æ˜¯ "è´¨é‡é—®é¢˜" (ä¸å¯ç”³è¯‰)ã€‚
            è¾“å‡º JSON æ ¼å¼: {"category": "...", "is_appealable": true/false, "confidence": 0.95}
            """},
            {"role": "user", "content": review_text}
        ]
    )
    return json.loads(response.choices[0].message.content)
```

**LLM é€‰æ‹©**:
- **OpenAI GPT-4**: æœ€å¼ºè¯­ä¹‰ç†è§£ (æ¨è)
- **Claude 3.5 Sonnet**: æ›´é•¿ä¸Šä¸‹æ–‡,é€‚åˆæ‰¹é‡å¤„ç†
- **å­—èŠ‚å†…éƒ¨ LLM**: å¦‚æœæœ‰å†…éƒ¨æ¨¡å‹,ä¼˜å…ˆä½¿ç”¨ (æˆæœ¬æ›´ä½)

**æˆæœ¬ä¼˜åŒ–**:
- ä½¿ç”¨ GPT-3.5-Turbo å¤„ç†ç®€å•æ¡ˆä¾‹ (æˆæœ¬é™ä½ 90%)
- ä»…å¯¹æ¨¡ç³Šæ¡ˆä¾‹ä½¿ç”¨ GPT-4
- æ‰¹é‡å¤„ç† (Batch API) é™ä½æˆæœ¬

---

#### 2.2 è®­ç»ƒä¸“ç”¨åˆ†ç±»æ¨¡å‹
```python
from transformers import AutoModelForSequenceClassification, AutoTokenizer

# ä½¿ç”¨ BERT å¾®è°ƒå·®è¯„åˆ†ç±»æ¨¡å‹
model = AutoModelForSequenceClassification.from_pretrained(
    'bert-base-multilingual-cased',
    num_labels=3  # Logistics / Quality / Service
)

# è®­ç»ƒæ•°æ®: å†å²å·®è¯„ + äººå·¥æ ‡æ³¨
train_model(model, historical_reviews_with_labels)
```

**ä¼˜åŠ¿**:
- æˆæœ¬æä½ (è‡ªæ‰˜ç®¡)
- å“åº”é€Ÿåº¦å¿« (< 100ms)
- å¯å®šåˆ¶åŒ– (é’ˆå¯¹ TikTok Shop ç‰¹å®šåœºæ™¯)

---

### Phase 3: æ•°æ®åº“ & æŒä¹…åŒ– (Week 5)

#### 3.1 æ•°æ®åº“æ¶æ„
```
PostgreSQL (ä¸»æ•°æ®åº“)
â”œâ”€â”€ shops (åº—é“ºä¿¡æ¯)
â”œâ”€â”€ sps_history (SPS å†å²è®°å½•)
â”œâ”€â”€ reviews (å·®è¯„æ•°æ®)
â”œâ”€â”€ ad_campaigns (å¹¿å‘Šæ•°æ®)
â””â”€â”€ alerts (å‘Šè­¦è®°å½•)

Redis (ç¼“å­˜å±‚)
â”œâ”€â”€ real_time_sps (å®æ—¶ SPS ç¼“å­˜, TTL=5min)
â”œâ”€â”€ api_rate_limit (API é™æµ)
â””â”€â”€ session_data (ç”¨æˆ·ä¼šè¯)

ClickHouse (åˆ†ææ•°æ®åº“)
â””â”€â”€ events (æ‰€æœ‰äº‹ä»¶æ—¥å¿—, ç”¨äº BI åˆ†æ)
```

#### 3.2 æ•°æ®å†™å…¥æµç¨‹
```python
# å®æ—¶æ•°æ®å†™å…¥
def update_shop_sps(shop_id, new_sps):
    # 1. å†™å…¥ PostgreSQL
    db.execute("""
        INSERT INTO sps_history (shop_id, sps_score, timestamp)
        VALUES (%s, %s, NOW())
    """, (shop_id, new_sps))

    # 2. æ›´æ–° Redis ç¼“å­˜
    redis.setex(f'sps:{shop_id}', 300, new_sps)

    # 3. è§¦å‘å‘Šè­¦æ£€æŸ¥
    if new_sps < 3.5:
        trigger_feishu_alert(shop_id, new_sps)
```

---

### Phase 4: å‘Šè­¦ç³»ç»Ÿ (Week 6)

#### 4.1 é£ä¹¦æœºå™¨äººé›†æˆ
```python
import requests

def send_feishu_alert(shop_id, sps_score):
    """å‘é€é£ä¹¦å‘Šè­¦"""
    webhook_url = os.getenv('FEISHU_WEBHOOK_URL')

    message = {
        "msg_type": "interactive",
        "card": {
            "header": {
                "title": {
                    "content": "ğŸš¨ SPS P0 Critical Alert",
                    "tag": "plain_text"
                },
                "template": "red"
            },
            "elements": [
                {
                    "tag": "div",
                    "text": {
                        "content": f"**åº—é“º**: {shop_id}\n**SPS**: {sps_score}\n**çŠ¶æ€**: å¤±å» Smart Promo èµ„æ ¼",
                        "tag": "lark_md"
                    }
                },
                {
                    "tag": "action",
                    "actions": [
                        {
                            "tag": "button",
                            "text": {"content": "æŸ¥çœ‹è¯¦æƒ…", "tag": "plain_text"},
                            "url": f"https://aegis.tiktokshop.com/shop/{shop_id}",
                            "type": "primary"
                        }
                    ]
                }
            ]
        }
    }

    requests.post(webhook_url, json=message)
```

#### 4.2 å‘Šè­¦è§„åˆ™å¼•æ“
```python
# é…ç½®åŒ–å‘Šè­¦è§„åˆ™
ALERT_RULES = [
    {
        'name': 'SPS_P0_CRITICAL',
        'condition': lambda shop: shop['sps_score'] < 3.5,
        'severity': 'P0',
        'channels': ['feishu', 'sms', 'email'],
        'recipients': ['ops_team', 'ian_chen']
    },
    {
        'name': 'ROAS_CIRCUIT_BREAKER',
        'condition': lambda ad: ad['roas'] < 1.5 and ad['spend_velocity'] > 2.0,
        'severity': 'P1',
        'channels': ['feishu'],
        'action': 'auto_pause_ad'
    }
]
```

---

### Phase 5: å‰ç«¯å‡çº§ (Week 7-8)

#### 5.1 ä» Streamlit è¿ç§»åˆ° React
**ä¸ºä»€ä¹ˆè¦è¿ç§»?**
- Streamlit é€‚åˆåŸå‹,ä½†ç”Ÿäº§ç¯å¢ƒéœ€è¦æ›´çµæ´»çš„ UI
- React æ”¯æŒæ›´å¤æ‚çš„äº¤äº’ (æ‹–æ‹½ã€å®æ—¶æ›´æ–°ã€æƒé™æ§åˆ¶)

**æŠ€æœ¯æ ˆ**:
```
Frontend: React + TypeScript + Ant Design
State Management: Redux Toolkit
Charts: ECharts / Recharts
Real-time: WebSocket (Socket.io)
```

#### 5.2 ä¿ç•™ Streamlit ä½œä¸ºå†…éƒ¨å·¥å…·
```
ç”Ÿäº§ç¯å¢ƒ (å¯¹å¤–):
â”œâ”€â”€ React Dashboard (ç»™è¿è¥å›¢é˜Ÿç”¨)
â””â”€â”€ Mobile App (ç»™å€¼ç­äººå‘˜ç”¨)

å†…éƒ¨å·¥å…· (å¯¹å†…):
â””â”€â”€ Streamlit (ç»™æ•°æ®åˆ†æå¸ˆå¿«é€Ÿæ¢ç´¢æ•°æ®)
```

---

## æŠ€æœ¯æ ˆå‡çº§

### å®Œæ•´æŠ€æœ¯æ ˆ (ç”Ÿäº§çº§)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Frontend Layer                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ React + TypeScript + Ant Design         â”‚
â”‚ WebSocket (å®æ—¶æ•°æ®æ¨é€)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          API Gateway                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FastAPI (Python) / Node.js              â”‚
â”‚ JWT Authentication                      â”‚
â”‚ Rate Limiting (Redis)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Business Logic Layer           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SPS Monitor Service (Python)            â”‚
â”‚ NRR Analyzer Service (Python + LLM)     â”‚
â”‚ Smart+ Circuit Breaker (Python)         â”‚
â”‚ Alert Engine (Python)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          Data Layer                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ PostgreSQL (ä¸»æ•°æ®åº“)                   â”‚
â”‚ Redis (ç¼“å­˜ + æ¶ˆæ¯é˜Ÿåˆ—)                 â”‚
â”‚ ClickHouse (åˆ†ææ•°æ®åº“)                 â”‚
â”‚ S3 (æ–‡ä»¶å­˜å‚¨)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          External APIs                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ TikTok Shop API                         â”‚
â”‚ OpenAI API / Claude API                 â”‚
â”‚ FedEx / UPS API                         â”‚
â”‚ Feishu Webhook                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## éƒ¨ç½²æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: äº‘åŸç”Ÿéƒ¨ç½² (æ¨è)

#### æ¶æ„
```
Kubernetes (EKS / GKE / AKS)
â”œâ”€â”€ Frontend Pod (React, Nginx)
â”œâ”€â”€ API Pod (FastAPI, 3 replicas)
â”œâ”€â”€ Worker Pod (Celery, 5 replicas)
â””â”€â”€ Monitoring (Prometheus + Grafana)

Database
â”œâ”€â”€ RDS PostgreSQL (Multi-AZ)
â”œâ”€â”€ ElastiCache Redis (Cluster Mode)
â””â”€â”€ ClickHouse Cloud
```

#### æˆæœ¬ä¼°ç®— (AWS)
| èµ„æº | é…ç½® | æœˆæˆæœ¬ (USD) |
|------|------|-------------|
| EKS Cluster | 3 nodes (t3.medium) | $150 |
| RDS PostgreSQL | db.t3.medium | $80 |
| ElastiCache Redis | cache.t3.micro | $15 |
| ClickHouse Cloud | 100GB | $50 |
| Load Balancer | ALB | $20 |
| S3 + CloudFront | 100GB | $10 |
| **æ€»è®¡** | | **$325/æœˆ** |

---

### æ–¹æ¡ˆ 2: Serverless éƒ¨ç½² (ä½æˆæœ¬)

#### æ¶æ„
```
Vercel (Frontend)
â””â”€â”€ React App (å…è´¹é¢åº¦)

AWS Lambda (Backend)
â”œâ”€â”€ API Functions (æŒ‰è°ƒç”¨è®¡è´¹)
â””â”€â”€ Scheduled Jobs (Cron)

Supabase (Database)
â””â”€â”€ PostgreSQL + Redis (å…è´¹é¢åº¦)
```

#### æˆæœ¬ä¼°ç®—
| èµ„æº | æœˆæˆæœ¬ (USD) |
|------|-------------|
| Vercel | $0 (Hobby Plan) |
| AWS Lambda | $5 (100ä¸‡æ¬¡è°ƒç”¨) |
| Supabase | $0 (å…è´¹é¢åº¦) |
| OpenAI API | $50 (1000æ¬¡è°ƒç”¨/å¤©) |
| **æ€»è®¡** | **$55/æœˆ** |

---

## æˆæœ¬ä¼°ç®—

### MVP é˜¶æ®µ (å½“å‰)
- **å¼€å‘æˆæœ¬**: 2 å°æ—¶ (ä½ çš„æ—¶é—´)
- **è¿è¡Œæˆæœ¬**: $0 (æœ¬åœ°è¿è¡Œ)
- **ç»´æŠ¤æˆæœ¬**: $0

### ç”Ÿäº§çº§ (Phase 1-5 å®Œæˆå)
- **å¼€å‘æˆæœ¬**: 8 å‘¨ * 1 äºº = 2 äººæœˆ
- **è¿è¡Œæˆæœ¬**: $325/æœˆ (äº‘åŸç”Ÿ) æˆ– $55/æœˆ (Serverless)
- **ç»´æŠ¤æˆæœ¬**: 0.5 äººæœˆ/æœˆ

### ROI åˆ†æ
å‡è®¾ç³»ç»Ÿæ¯æœˆæ‹¦æˆª $50,000 çš„äºæŸå¹¿å‘Šé¢„ç®—:
```
å¹´åº¦èŠ‚çœ: $50,000 * 12 = $600,000
å¹´åº¦æˆæœ¬: $325 * 12 + $30,000 (äººåŠ›) = $33,900
ROI: ($600,000 - $33,900) / $33,900 = 1,670%
```

---

## ğŸ¯ æ€»ç»“

### MVP â†’ ç”Ÿäº§çº§çš„å…³é”®è·¯å¾„
1. **Week 1-2**: å¯¹æ¥ TikTok Shop API (æ•°æ®çœŸå®åŒ–)
2. **Week 3-4**: æ¥å…¥ LLM API (AI èƒ½åŠ›å¢å¼º)
3. **Week 5**: æ­å»ºæ•°æ®åº“ (æŒä¹…åŒ–)
4. **Week 6**: é›†æˆé£ä¹¦å‘Šè­¦ (é—­ç¯)
5. **Week 7-8**: å‰ç«¯å‡çº§ (ç”¨æˆ·ä½“éªŒ)

### ä½ çš„ä¼˜åŠ¿
- âœ… å·²æœ‰å¯è¿è¡Œçš„ MVP (æ¯”ä»é›¶å¼€å§‹å¿« 80%)
- âœ… ç†è§£ä¸šåŠ¡é€»è¾‘ (SPS/NRR/ROAS)
- âœ… ç»Ÿè®¡å­¦èƒŒæ™¯ (æ•°æ®å»ºæ¨¡ä¼˜åŠ¿)
- âœ… æ˜¥èŠ‚å…¨å‹¤æ‰¿è¯º (æ—¶é—´ä¼˜åŠ¿)

### é¢è¯•æ—¶å¦‚ä½•å±•ç¤ºè¿™ä¸ªè·¯çº¿å›¾
> "è¿™æ˜¯æˆ‘çš„ MVP,ç”¨ 2 å°æ—¶æ­å»ºå®Œæˆã€‚å¦‚æœå…¥èŒ,æˆ‘å¯ä»¥åœ¨ 8 å‘¨å†…å°†å®ƒæ‰©å±•ä¸ºç”Ÿäº§çº§ç³»ç»Ÿ,é¢„è®¡æ¯å¹´ä¸ºå…¬å¸èŠ‚çœ $600,000 çš„å¹¿å‘ŠäºæŸã€‚æˆ‘å·²ç»è§„åˆ’å¥½äº†æŠ€æœ¯æ ˆå’Œéƒ¨ç½²æ–¹æ¡ˆ,éšæ—¶å¯ä»¥å¼€å§‹ã€‚"

---

**è¿™å°±æ˜¯"é™ç»´æ‰“å‡»"çš„å®Œæ•´å¼¹è¯åº“ã€‚** ğŸš€
